<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>WebXR – Jet Loader (Debug)</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>html,body{margin:0;height:100%;overflow:hidden;}#hud{position:fixed;left:8px;top:8px;background:#0008;color:#fff;padding:6px 8px;border-radius:8px;font:12px system-ui;z-index:1}</style>
</head>
<body>
<div id="hud">If no “Enter VR” button: ensure HTTPS.<br>Open devtools console for loader logs.</div>

<script type="module">
import * as THREE from "js/three.module.js";
import { VRButton } from "js/VRButton.js";
import { GLTFLoader } from "js/GLTFLoader.js";

const scene = new THREE.Scene();
scene.background = new THREE.Color(0x202225);

// lights
scene.add(new THREE.HemisphereLight(0xffffff, 0x404040, 1.0));
const d = new THREE.DirectionalLight(0xffffff, 1.0); d.position.set(10,20,10); scene.add(d);

// camera & renderer
const camera = new THREE.PerspectiveCamera(70, innerWidth/innerHeight, 0.01, 1000);
const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setPixelRatio(devicePixelRatio);
renderer.setSize(innerWidth, innerHeight);
renderer.xr.enabled = true;
document.body.appendChild(renderer.domElement);
document.body.appendChild(VRButton.createButton(renderer));

// helpers: grid + axes
const grid = new THREE.GridHelper(200, 200);
grid.position.y = 0; scene.add(grid);
const axes = new THREE.AxesHelper(1.0); // X=red, Y=green, Z=blue
axes.position.set(0,0.01,0); scene.add(axes);

// floor (receives light)
const floor = new THREE.Mesh(
  new THREE.PlaneGeometry(200,200),
  new THREE.MeshStandardMaterial({color:0x303338, roughness:1})
);
floor.rotation.x = -Math.PI/2;
scene.add(floor);

// load model
const root = new THREE.Group(); scene.add(root);
const loader = new GLTFLoader();

// 1) Set this to your actual file (relative path!)
//    e.g. "jet.glb"  OR  "models/jet.glb"
const MODEL_URL = "jet.glb";

// 2) If your file fails, uncomment this known-good URL to confirm loader works:
// const MODEL_URL = "https://raw.githubusercontent.com/KhronosGroup/glTF-Sample-Models/master/2.0/DamagedHelmet/glTF-Binary/DamagedHelmet.glb";

console.log("Loading", MODEL_URL);
loader.load(MODEL_URL, (gltf)=>{
  console.log("Loaded OK:", MODEL_URL);
  root.clear();
  const obj = gltf.scene;
  // If model authored in centimeters, use 0.01
  const uniformScale = 1.0; // try 0.01 if it appears gigantic/vanishes
  obj.scale.setScalar(uniformScale);
  root.add(obj);

  // recenter model to world origin & onto floor
  const bbox = new THREE.Box3().setFromObject(obj);
  const center = bbox.getCenter(new THREE.Vector3());
  const offset = new THREE.Vector3(-center.x, -bbox.min.y, -center.z);
  obj.position.add(offset);

  console.log("Bounds size (m):", bbox.getSize(new THREE.Vector3()));
}, (ev)=>{
  const pct = ev.total ? Math.round(ev.loaded/ev.total*100) : Math.round(ev.loaded/1024) + " KB";
  console.log(`Loading… ${pct}`);
}, (err)=>{
  console.error("GLB load error:", err);
});

addEventListener('resize', ()=>{
  camera.aspect = innerWidth/innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(innerWidth, innerHeight);
});

renderer.setAnimationLoop(()=>renderer.render(scene, camera));
</script>
</body>
</html>
